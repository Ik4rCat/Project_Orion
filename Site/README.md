# Project Orion

## О проекте
Project Orion - это веб-приложение для управления задачами, заметками и групп пользователей. Приложение позволяет пользователям регистрироваться, создавать задачи, заметки и организовывать их по группам.

## Требования
- .NET 9.0
- SQL Server (или LocalDB)
- Node.js и npm (для фронтенд-библиотек)

## Установка и запуск

### 1. Клонирование репозитория
```bash
git clone [url-репозитория]
cd Site
```

### 2. Восстановление пакетов
```bash
dotnet restore
```

### 3. Создание миграций и обновление базы данных
```bash
cd Orion.Infrastructure
dotnet ef migrations add InitialCreate --startup-project ../Orion.Web
dotnet ef database update --startup-project ../Orion.Web
```

### 4. Запуск приложения
```bash
cd ../Orion.Web
dotnet run
```

После запуска приложение будет доступно по адресу: `https://localhost:5001` или `http://localhost:5000`

## Вход под администратором
При первом запуске приложения автоматически создается аккаунт администратора:

- **Email**: admin@orion.com
- **Пароль**: Admin123!

Вы можете войти в систему, используя эти учетные данные, и получить доступ к административным функциям.

## Функциональность
- **Задачи**: создание, редактирование и отслеживание выполнения задач
- **Заметки**: создание и редактирование заметок
- **Группы**: организация задач и заметок по группам
- **Профиль пользователя**: управление личными данными

## Решение проблем

### Проблемы с базой данных
Если у вас возникли проблемы с подключением к базе данных, убедитесь, что строка подключения в `appsettings.json` настроена правильно:

```json
"ConnectionStrings": {
  "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=OrionDB;Trusted_Connection=True;MultipleActiveResultSets=true"
}
```

### Ошибки при сборке
Если вы сталкиваетесь с ошибками при сборке, убедитесь, что у вас установлена правильная версия .NET SDK:

```bash
dotnet --version
```

При необходимости обновите SDK до требуемой версии.

### Проблемы с созданием заметок или групп
Если возникают проблемы при создании заметок или групп, проверьте следующее:

1. Убедитесь, что вы авторизованы в системе - неавторизованные пользователи не могут создавать контент
2. Проверьте, что база данных обновлена до последней версии с помощью команды:
   ```bash
   cd Orion.Infrastructure
   dotnet ef database update --startup-project ../Orion.Web
   ```
3. Если ошибки продолжаются, проверьте журналы приложения, которые находятся в директории `Orion.Web/logs`

### Проблемы с доступом к дашборду
Если у вас возникают проблемы с доступом к дашборду или другим защищенным страницам:

1. Убедитесь, что вы успешно вошли в систему
2. Если после успешного входа вас перенаправляет обратно на страницу входа, проверьте следующее:
   - Cookies разрешены в вашем браузере
   - Аутентификационный токен не истек
   - У вашего пользователя есть необходимые права доступа

Если вы по-прежнему не можете получить доступ к дашборду, попробуйте:
1. Очистить кэш и cookies браузера
2. Попробовать войти под учетной записью администратора
3. Перезапустить приложение

### Проблемы при запуске приложения
Если при запуске приложения возникают ошибки:

1. **Ошибка занятого порта**: Если порт 5000 или 5001 уже используется, измените порт в файле `Orion.Web/Properties/launchSettings.json`

2. **Ошибка с SQL Server LocalDB**: Убедитесь, что у вас установлен SQL Server LocalDB и он запущен. Вы можете проверить это командой:
   ```bash
   sqllocaldb info
   ```
   И запустить его, если необходимо:
   ```bash
   sqllocaldb start MSSQLLocalDB
   ```

3. **Ошибки с миграциями**: Если у вас возникают ошибки с миграциями базы данных, попробуйте сбросить базу данных и создать ее заново:
   ```bash
   cd Orion.Infrastructure
   dotnet ef database drop --startup-project ../Orion.Web --force
   dotnet ef database update --startup-project ../Orion.Web
   ``` 